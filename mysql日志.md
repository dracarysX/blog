#Mysql日志
>日志是`mysql`数据库的重要组成部分。日志文件中记录着`mysql`数据库运行期间发生的变化；也就是说用来记录`mysql`数据库的客户端连接状况、`SQL`语句的执行情况和错误信息等。当数据库遭到意外的损坏时，可以通过日志查看文件出错的原因，并且可以通过日志文件进行数据恢复。

## 错误日志
>在`mysql`数据库中，错误日志功能是默认开启的。并且，错误日志无法被禁止。默认情况下，错误日志存储在`mysql`数据库的数据文件中。默认情况下错误日志大概记录以下几个方面的信息：服务器启动和关闭过程中的信息（未必是错误信息，如`mysql`如何启动`InnoDB`的表空间文件的、如何初始化自己的存储引擎的等等）、服务器运行过程中的错误信息、事件调度器运行一个事件时产生的信息、在从服务器上启动服务器进程时产生的信息。
>一般`mysql`的日志信息配置可在`mysql`的配置文件中查看，也可以通过使用下面命令查看：
>
    show global variables like '%log%';
    #log_error 可以指定日志写入文件
    #log_warnings 是定义是否将警告信息也定义至错误日志中

>![mysql日志](http://7xrszf.com1.z0.glb.clouddn.com/mysql_log.png)

## 查询日志
>默认情况下查询日志是关闭的。由于查询日志会记录用户的所有操作，其中还包含增删查改等信息，在并发操作大的环境下会产生大量的信息从而导致不必要的磁盘`IO`，会影响`mysql`的性能的。如若不是为了调试数据库的目的建议不要开启查询日志。(PS：开发环境下强烈建议开启。)
>
    | general_log                             | ON                            |
    | general_log_file                        | /var/log/mysql/mysql.log      |
    # 设置这两项即可指定开启查询日志。
    #log_output 指定文件写入地方，默认写入文件。file(文件)，table(表)。如果定义table的话，就会写入到mysql库下面的general_log表中。（个人喜欢写入到table中，很方便查询。）
>![general_log](http://7xrszf.com1.z0.glb.clouddn.com/mysql_1.png)

## 慢查询日志
>慢查询日志是用来记录执行时间超过指定时间的查询语句。通过慢查询日志，可以查找出哪些查询语句的执行效率很低，以便进行优化。一般建议开启，它对服务器性能的影响微乎其微，但是可以记录`mysql`服务器上执行了很长时间的查询语句。可以帮助我们定位性能问题的。
>
    | slow_query_log                          | ON                            |
    | slow_query_log_file                     | /var/log/mysql/mysql-slow.log |
    # 设置上面两项即可开启慢查询日志。
    +-----------------+----------+
    | Variable_name   | Value    |
    +-----------------+----------+
    | long_query_time | 2.000000 |
    +-----------------+----------+
    #一般都是通过long_query_time选项来设置这个时间值，时间以秒为单位，可以精确到微秒。如果查询时间超过了这个时间值（默认为10秒），这个查询语句将被记录到慢查询日志中。(个人建议设置成500ms)
>PS：其中这个慢查询时间并不是只表示语句自身执行超过10秒还包含由于其他资源被征用造成阻塞的查询执行时间或其他原因等都被记录到慢查询中。所以这个慢查的时长表示从查询开始到查询结束中间包含可能的任何原因所经历的所有时间。

## 备注
>以上设置皆可通过配置文件设置。或者在命令行中间设置也行。
>
    set global general_log = on;
    set global long_query_time = 0.5;
    ......
>当然`mysql`中间还有很多其他的日志设置，二进制日志、事务日志等等，不过暂时未接触到，所以这里也不做多的介绍了。

